(()=>{"use strict";function e({coords:{latitude:e,longitude:t}}){console.log(`${e}, ${t}`),fetch(`https://eu1.locationiq.com/v1/reverse.php?key=pk.80f74496452169d08d8ab400676ea8d9&lat=${e}&lon=${t}&format=json&accept-language=en`).then((e=>e.json())).then((e=>{a(e.address.town)}))}const t=new Map;let n=document.getElementById("tbody"),o=document.querySelector(".cityMap");function c(){let e="",c="";t.forEach((t=>{const[n,o,a,r,d]=t;e+=`\n        <tr>\n            <td>${n}</td>\n            <td>${o}</td>\n            <td>${a}</td>\n            <td>${a}</td>\n        </tr>\n       \n        `,c+=`<img src='https://maps.locationiq.com/v2/staticmap?key=pk.c6c8e0f26d559c4194d567e972e29b74&center=${r},${d}&zoom=12&size=400x400&markers=${r},${d}|icon:large-red-cutout'></img>`})),n.innerHTML=e,o.innerHTML=c}function a(e){return fetch("http://api.weatherstack.com/current?access_key=8a2380626129e4b4b0b74c8703d3d9c3&query="+e).then((e=>e.json())).then((e=>{const{current:{temperature:n},location:{country:o,name:a,lat:r,lon:d}}=e;t.set(a,[a,o,n,r,d]),c(),localStorage.setItem(e.location.name,JSON.stringify(e))}))}let r=document.querySelector(".input"),d=document.getElementById("form"),l=document.getElementById("clear"),i=document.getElementById("myWeather");document.getElementById("tbody"),document.querySelector(".cityMap"),d.addEventListener("submit",(function(e){e.preventDefault(),a(r.value)})),i.addEventListener("click",(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e):alert("Ваш браузер не поддерживает Geolocation API")})),window.addEventListener("load",(()=>{!function(){let e=Object.keys(localStorage);for(let t of e)a(t).then((e=>{localStorage.setItem(key,JSON.stringify(e))}))}()})),l.addEventListener("click",(()=>{t.clear(),c(),localStorage.clear(),dataArray=[]}))})();